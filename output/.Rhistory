write.csv(df_households, 'df_households_coordinates.csv')
df_households$type <- 'home'
df_households$lid <- paste0('home_', seq.int(nrow(df_households)))
df_households <- df_households %>%
select(hh_ID, lid, PC6, type, longitude, latitude)
write.csv(df_households, 'df_households_locations.csv', row.names = FALSE)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
# Read locations
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_homes <- read.csv('df_households_locations.csv')
setwd(this.dir())
setwd('../DHZW_locations/location_folders/work/data')
df_work <- read.csv('work_DHZW.csv')
setwd(this.dir())
setwd('../DHZW_locations/location_folders/schools/data')
df_schools <- st_read('schools_DHZW')
setwd(this.dir())
setwd('../DHZW_locations/location_folders/shopping/data')
df_shoppings <- read.csv('shopping_DHZW.csv')
setwd(this.dir())
setwd('../DHZW_locations/location_folders/sport/data')
df_sport <- read.csv('sport_DHZW.csv')
setwd('../DHZW_locations/location_folders/schools/data')
df_schools <- as.data.frame(st_read('schools_DHZW'))
setwd(this.dir())
setwd('../DHZW_locations/location_folders/schools/data')
df_schools <- as.data.frame(st_read('schools_DHZW'))
View(df_sport)
df_schools <- df_schools %>%
select(PC6, PC4, longitude, latitude, type, lid)
View(df_schools)
df_locations <- rbind(df_homes,
df_work,
df_schools,
df_shoppings,
df_sport)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
# Read locations
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_homes <- read.csv('df_households_locations.csv')
colnames(df_homes)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/work/data')
df_work <- read.csv('work_DHZW.csv')
colnames(df_homes)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/schools/data')
df_schools <- as.data.frame(st_read('schools_DHZW'))
df_schools <- df_schools %>%
select(PC6, PC4, longitude, latitude, type, lid)
colnames(df_schools)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/shopping/data')
df_shoppings <- read.csv('shopping_DHZW.csv')
colnames(df_shoppings)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/sport/data')
df_sport <- read.csv('sport_DHZW.csv')
colnames(df_sport)
library(this.path)
library(readr)
library(sf)
library(dplyr)
# Ideally, I would use the BAG dataset to assign a precise home. However, the households generation produced more households than the ones in BAG. Hence, I am using the centroid of the PC6.
# Load household
setwd(this.dir())
setwd('../../../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_households <- read.csv('df_households_DHZW_2019.csv')
# Load PC6
setwd(this.dir())
setwd('../../../DHZW_synthetic-population/data/shapefiles/processed')
df_PC6 <- st_read('DHZW_PC6_shapefiles')
# Transform into WGS84
df_PC6 <- st_transform(df_PC6, "+proj=longlat +datum=WGS84")
# compute the centroid
df_centroid_PC6 <- st_centroid(df_PC6)
df_coordinates <- data.frame(st_coordinates(df_centroid_PC6))
colnames(df_coordinates) <- c('longitude', 'latitude')
df_PC6 = cbind(df_PC6, df_coordinates)
df_PC6 <- data.frame(df_PC6)
df_PC6 = subset(df_PC6, select = -c(geometry))
# Manually add missing PC6
unique(df_households[! df_households$PC6 %in% df_PC6$PC6,]$PC6)
df_PC6[nrow(df_PC6) + 1,] = c("2542RK", 4.2777, 52.0391)
df_PC6[nrow(df_PC6) + 1,] = c("2543SH", 4.2609, 52.0432)
df_PC6[nrow(df_PC6) + 1,] = c("2545XJ", 4.2677, 52.0515)
unique(df_households[! df_households$PC6 %in% df_PC6$PC6,]$PC6)
# assign coordinates to households
df_households <- merge(df_households, df_PC6, by = 'PC6')
# Save dataset
setwd(this.dir())
setwd('data')
write.csv(df_households, 'df_households_coordinates.csv')
df_households$type <- 'home'
df_households$lid <- paste0('home_', seq.int(nrow(df_households)))
df_households <- df_households %>%
select(hh_ID, lid, PC6, type, longitude, latitude)
df_households <- df_households %>%
mutate(PC4 = gsub('.{2}$', '', PC6)) %>%
write.csv(df_households, 'df_households_locations.csv', row.names = FALSE)
View(df_households)
library(this.path)
library(readr)
library(sf)
library(dplyr)
# Ideally, I would use the BAG dataset to assign a precise home. However, the households generation produced more households than the ones in BAG. Hence, I am using the centroid of the PC6.
# Load household
setwd(this.dir())
setwd('../../../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_households <- read.csv('df_households_DHZW_2019.csv')
# Load PC6
setwd(this.dir())
setwd('../../../DHZW_synthetic-population/data/shapefiles/processed')
df_PC6 <- st_read('DHZW_PC6_shapefiles')
# Transform into WGS84
df_PC6 <- st_transform(df_PC6, "+proj=longlat +datum=WGS84")
# compute the centroid
df_centroid_PC6 <- st_centroid(df_PC6)
df_coordinates <- data.frame(st_coordinates(df_centroid_PC6))
colnames(df_coordinates) <- c('longitude', 'latitude')
df_PC6 = cbind(df_PC6, df_coordinates)
df_PC6 <- data.frame(df_PC6)
df_PC6 = subset(df_PC6, select = -c(geometry))
# Manually add missing PC6
unique(df_households[! df_households$PC6 %in% df_PC6$PC6,]$PC6)
df_PC6[nrow(df_PC6) + 1,] = c("2542RK", 4.2777, 52.0391)
df_PC6[nrow(df_PC6) + 1,] = c("2543SH", 4.2609, 52.0432)
df_PC6[nrow(df_PC6) + 1,] = c("2545XJ", 4.2677, 52.0515)
unique(df_households[! df_households$PC6 %in% df_PC6$PC6,]$PC6)
# assign coordinates to households
df_households <- merge(df_households, df_PC6, by = 'PC6')
# Save dataset
setwd(this.dir())
setwd('data')
write.csv(df_households, 'df_households_coordinates.csv')
df_households$type <- 'home'
df_households$lid <- paste0('home_', seq.int(nrow(df_households)))
df_households <- df_households %>%
select(hh_ID, lid, PC6, type, longitude, latitude)
df_households <- df_households %>%
mutate(PC4 = gsub('.{2}$', '', PC6))
write.csv(df_households, 'df_households_locations.csv', row.names = FALSE)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
# Read locations
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_homes <- read.csv('df_households_locations.csv')
colnames(df_homes)
df_homes <- df_homes %>%
select("PC6", "PC4", "longitude", "latitude", "type", "lid")
setwd(this.dir())
setwd('../DHZW_locations/location_folders/work/data')
df_work <- read.csv('work_DHZW.csv')
colnames(df_work)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/schools/data')
df_schools <- as.data.frame(st_read('schools_DHZW'))
df_schools <- df_schools %>%
select(PC6, PC4, longitude, latitude, type, lid)
colnames(df_schools)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/shopping/data')
df_shoppings <- read.csv('shopping_DHZW.csv')
colnames(df_shoppings)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/sport/data')
df_sport <- read.csv('sport_DHZW.csv')
colnames(df_sport)
df_locations <- rbind(df_homes,
df_work,
df_schools,
df_shoppings,
df_sport)
View(df_locations)
setwd(this.dir())
write.csv('locations.csv', row.names = FALSE)
write.csv('locations.csv', row.names = FALSE)
write.csv(df_locations, 'locations.csv', row.names = FALSE)
setwd("~/GitHub projects/DHZW_synthetic_population_to_Sim2APL")
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read locations
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_homes <- read.csv('df_households_locations.csv')
colnames(df_homes)
df_homes <- df_homes %>%
select("PC6", "PC4", "longitude", "latitude", "type", "lid")
setwd(this.dir())
setwd('../DHZW_locations/location_folders/work/data')
df_work <- read.csv('work_DHZW.csv')
colnames(df_work)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/schools/data')
df_schools <- as.data.frame(st_read('schools_DHZW'))
df_schools <- df_schools %>%
select(PC6, PC4, longitude, latitude, type, lid)
colnames(df_schools)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/shopping/data')
df_shoppings <- read.csv('shopping_DHZW.csv')
colnames(df_shoppings)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/sport/data')
df_sport <- read.csv('sport_DHZW.csv')
colnames(df_sport)
df_locations <- rbind(df_homes,
df_work,
df_schools,
df_shoppings,
df_sport)
setwd(this.dir())
setwd('data')
write.csv(df_locations, 'locations.csv', row.names = FALSE)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
# Read locations
setwd(this.dir())
setwd('data')
df_locations <- read.csv('locations.csv')
df_activities_merged <- left_join(df_activities, df_locations)
View(df_activities)
View(df_locations)
View(df_activities_merged)
View(df_activities)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
# Read locations
setwd(this.dir())
setwd('data')
df_locations <- read.csv('locations.csv')
df_activities_merged <- left_join(df_activities, df_locations, by='lid')
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
df_activities <- subset(df_activities, select=-c(PC4))
# Read locations
setwd(this.dir())
setwd('data')
df_locations <- read.csv('locations.csv')
df_activities_merged <- left_join(df_activities, df_locations, by='lid')
View(df_activities_merged)
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$PC6 <- 000000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$PC4 <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$longitude <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$latitude <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$type <- 'NA'
# 1 day
df_activities_merged <- df_activities_merged[df_activities_merged$day_of_week==1,]
write.csv(df_activities_merged, 'SIM2APL_activities.csv', row.names = FALSE)
library(this.path)
library(readr)
library(sf)
library(dplyr)
# Ideally, I would use the BAG dataset to assign a precise home. However, the households generation produced more households than the ones in BAG. Hence, I am using the centroid of the PC6.
# Load household
setwd(this.dir())
setwd('../../../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_households <- read.csv('df_households_DHZW_2019.csv')
# Load PC6
setwd(this.dir())
setwd('../../../DHZW_synthetic-population/data/shapefiles/processed')
df_PC6 <- st_read('DHZW_PC6_shapefiles')
# Transform into WGS84
df_PC6 <- st_transform(df_PC6, "+proj=longlat +datum=WGS84")
# compute the centroid
df_centroid_PC6 <- st_centroid(df_PC6)
df_coordinates <- data.frame(st_coordinates(df_centroid_PC6))
colnames(df_coordinates) <- c('longitude', 'latitude')
df_PC6 = cbind(df_PC6, df_coordinates)
df_PC6 <- data.frame(df_PC6)
df_PC6 = subset(df_PC6, select = -c(geometry))
# Manually add missing PC6
unique(df_households[! df_households$PC6 %in% df_PC6$PC6,]$PC6)
df_PC6[nrow(df_PC6) + 1,] = c("2542RK", 4.2777, 52.0391)
df_PC6[nrow(df_PC6) + 1,] = c("2543SH", 4.2609, 52.0432)
df_PC6[nrow(df_PC6) + 1,] = c("2545XJ", 4.2677, 52.0515)
unique(df_households[! df_households$PC6 %in% df_PC6$PC6,]$PC6)
# assign coordinates to households
df_households <- merge(df_households, df_PC6, by = 'PC6')
# Save dataset
setwd(this.dir())
setwd('data')
write.csv(df_households, 'df_households_coordinates.csv', row.names = FALSE)
df_households$type <- 'home'
df_households$lid <- paste0('home_', seq.int(nrow(df_households)))
df_households <- df_households %>%
select(hh_ID, lid, PC6, type, longitude, latitude)
df_households <- df_households %>%
mutate(PC4 = gsub('.{2}$', '', PC6))
write.csv(df_households, 'df_households_locations.csv', row.names = FALSE)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
df_activities <- subset(df_activities, select=-c(PC4))
# Read locations
setwd(this.dir())
setwd('data')
df_locations <- read.csv('locations.csv')
df_activities_merged <- left_join(df_activities, df_locations, by='lid')
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$PC6 <- 000000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$PC4 <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$longitude <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$latitude <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$type <- 'NA'
# 1 day
df_activities_merged <- df_activities_merged[df_activities_merged$day_of_week==1,]
write.csv(df_activities_merged, 'SIM2APL_activities.csv', row.names = FALSE, quote=FALSE)
library(readr)
library(dplyr)
library(this.path)
library(sf)
# Read activities
setwd(this.dir())
setwd('../DHZW_assign_locations/data')
df_activities <- read.csv('df_synthetic_activities.csv')
df_activities <- subset(df_activities, select=-c(PC4))
# Read locations
setwd(this.dir())
setwd('data')
df_locations <- read.csv('locations.csv')
df_activities_merged <- left_join(df_activities, df_locations, by='lid')
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$PC6 <- 000000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$PC4 <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$longitude <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$latitude <- 0000
df_activities_merged[df_activities_merged$lid == 'outside DHZW',]$type <- 'NA'
# 1 day
df_activities_merged <- df_activities_merged[df_activities_merged$day_of_week==1,]
write.csv(df_activities_merged, 'SIM2APL_activities.csv', row.names = FALSE)
setwd("~/GitHub projects/DHZW_synthetic_population_to_Sim2APL")
library(readr)
library(this)
setwd(this.dir())
setwd('../DHW_synthetic_population/outputsynthetic-population-households/4_car_2022-12-26_15-50/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHW_synthetic_population/output/synthetic-population-households/4_car_2022-12-26_15-50/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHW_synthetic_population/output/synthetic-population-households/4_car_2022-12-26_15-50/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHW_synthetic_population/output/synthetic-population-households/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHWW_synthetic_population/output/synthetic-population-households/4_car_2022-12-26_15-50/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHWZ_synthetic_population/output/synthetic-population-households/4_car_2022-12-26_15-50/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic_population/output/synthetic-population-households/4_car_2022-12-26_15-50/')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_synthetic_population <- read.csv('synthetic_population_DHZW_2019.csv')
setwd(this.dir())
setwd('data')
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_synthetic_population <- read.csv('synthetic_population_DHZW_2019.csv')
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_households <- read.csv('df_households_coordinates.csv')
setwd(this.dir())
setwd('data')
df_households <- read.csv('SIM2APL_activities.csv')
setwd(this.dir())
setwd('output')
write.csv(df_synthetic_population, 'DHZW_synthetic_population.csv', row.names = FALSE, quote=FALSE)
write.csv(df_households, 'DHZW_households.csv', row.names = FALSE, quote=FALSE)
write.csv(df_households, 'DHZW_activities_locations.csv', row.names = FALSE, quote=FALSE)
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_synthetic_population <- read.csv('synthetic_population_DHZW_2019.csv')
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_households <- read.csv('df_households_coordinates.csv')
setwd(this.dir())
setwd('data')
df_activities <- read.csv('SIM2APL_activities.csv')
setwd(this.dir())
setwd('output')
write.csv(df_synthetic_population, 'DHZW_synthetic_population.csv', row.names = FALSE, quote=FALSE)
write.csv(df_households, 'DHZW_households.csv', row.names = FALSE, quote=FALSE)
write.csv(df_activities, 'DHZW_activities_locations.csv', row.names = FALSE, quote=FALSE)
df_activities <- df_activities %>%
rename(pid = agent_ID)
View(df_activities)
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_synthetic_population <- read.csv('synthetic_population_DHZW_2019.csv')
df_synthetic_population <- df_synthetic_population %>%
rename(pid = agent_ID)
df_synthetic_population$pid <-gsub("[^0-9.-]", "", df_synthetic_population$pid)
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_households <- read.csv('df_households_coordinates.csv')
setwd(this.dir())
setwd('data')
df_activities <- read.csv('SIM2APL_activities.csv')
df_activities <- df_activities %>%
rename(pid = agent_ID)
df_activities$pid <-gsub("[^0-9.-]", "", df_activities$pid)
setwd(this.dir())
setwd('output')
write.csv(df_synthetic_population, 'DHZW_synthetic_population.csv', row.names = FALSE, quote=FALSE)
write.csv(df_households, 'DHZW_households.csv', row.names = FALSE, quote=FALSE)
write.csv(df_activities, 'DHZW_activities_locations.csv', row.names = FALSE, quote=FALSE)
library(readr)
library(this)
setwd(this.dir())
setwd('../DHZW_synthetic-population/output/synthetic-population-households/4_car_2022-12-26_15-50')
df_synthetic_population <- read.csv('synthetic_population_DHZW_2019.csv')
df_synthetic_population <- df_synthetic_population %>%
rename(pid = agent_ID)
df_synthetic_population$pid <- as.numeric(gsub("[^0-9.-]", "", df_synthetic_population$pid))
setwd(this.dir())
setwd('../DHZW_locations/location_folders/home/data')
df_households <- read.csv('df_households_coordinates.csv')
setwd(this.dir())
setwd('data')
df_activities <- read.csv('SIM2APL_activities.csv')
df_activities <- df_activities %>%
rename(pid = agent_ID)
df_activities$pid <- as.numeric(gsub("[^0-9.-]", "", df_activities$pid))
setwd(this.dir())
setwd('output')
write.csv(df_synthetic_population, 'DHZW_synthetic_population.csv', row.names = FALSE, quote=FALSE)
write.csv(df_households, 'DHZW_households.csv', row.names = FALSE, quote=FALSE)
write.csv(df_activities, 'DHZW_activities_locations.csv', row.names = FALSE, quote=FALSE)
View(df_synthetic_population)
View(df_households)
View(df_synthetic_population)
length(unique(df_synthetic_population$hh_ID))
length(unique(df_households$hh_ID))
sprt(unique(df_households$hh_ID)
sprt(unique(df_households$hh_ID)
sort(unique(df_households$hh_ID)
)
View(df_households)
df_households$PC4 <-gsub('.{2}$', '', df_households$PC6)
View(df_households)
setwd(this.dir())
setwd('output')
write.csv(df_synthetic_population, 'DHZW_synthetic_population.csv', row.names = FALSE, quote=FALSE)
write.csv(df_households, 'DHZW_households.csv', row.names = FALSE, quote=FALSE)
